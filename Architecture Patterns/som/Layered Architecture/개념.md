# Layered Architecture

Layered Architecture 패턴은 구성 요소가 수평 계층으로 구성되는 N레이어 패턴이다. 이것은 대부분의 소프트웨어를 설계하는 전통적인 방법이며 자체 독립성을 의미한다. 이것은 모든 구성 요소가 상호 연결되어 있지만 서로 의존하지 않는다는 것을 의미한다. 

![](https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TEt1-6-rSSg2rSX7so8nOg.png)

이 아키텍처에는 4개의 레이어가 있으며 각 레이어는 모듈성과 그 안에 있는 구성 요소를 연결한다. 

- **Presentation Layer**: 여기에는 뷰 레이어과 관련된 모든 범주가 포함된다.
- **Business Layer**: 여기에는 비즈니스 로직이 포함된다.
- **Persistence Layer**: 개체 관계형 매핑과 같은 기능을 처리하는데 사용된다.
- **Database Layer**: 여기에 모든 데이터가 저장된다.

요청은 위에서 아래로 모든 계층을 통과해야 한다. 여기에는 2가지 이유가 있다. 하나는 해당 계층에 포함되는 유사한 구성 요소가 있기 때문이고, 다른 하나는 독립적인 레이어을 제공하기 때문이다.

### 유사한 구성 요소

유사한 구성요소가 함께 있다는 것은 특정 레이어와 관련된 모든 것이 해당 단일 레이어에 머무르는 것을 의미한다. 이를 통해 구성 요소 유형을 명확하게 구분할 수 있으며 유사한 프로그래밍 코드를 한 위치에 모으는 데 도움이 된다.

### 독립적인 레이어

레이어를 분리하면 레이어가 서로 독립적인 형태가 된다. 예를 들어 데이터베이스를 Oracle 서버에서 SQL 서버로 변경하려는 경우 데이터베이스 계층에 큰 영향을 주지만 다른 계층에는 영향을 미치지 않는다. 마찬가지로 작성된 사용자 정의 비즈니스 계층이 있고 이를 비즈니스 규칙 엔진용으로 변경하려고 한다고 가정하자. 잘 정의된 계층화된 아키텍처가 있는 경우 변경사항은 다른 계층에 영향을 미치지 않는다. 

## 주의점

![](https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4ZGqdYDT7_oRnBxFnM3Q8g.png)

Layered Architecture 패턴은 언급된 레이어 외에 추가 레이어를 갖도록 수정할 수 있다. 이것은 Hybrid Layered Architecture로 알려져 있다. 그러나 이제 비즈니스 레이어가 지속성 레이어로 도달하기 위해 서비스 계층을 거쳐야 하므로 이는 이상적인 시나리오가 아니다. 이 요청은 서비스 계층을 통과해도 아무런 가치가 없는다. 우리는 이것을 architecture sinkhole anti-pattern이라고 부른다. 요청은 각 계층에서 수행되는 논리가 거의 또는 전혀 없는 계층을 통과한다.

![](https://miro.medium.com/v2/resize:fit:1400/format:webp/1*urTKcY7bxl7kOZPj6zEbpw.png)

이를 해결할 수 있는 유일한 방법은 Optional 레이어를 열린 레이어로 만드는 것이다. 즉 Optional 레이어가 전송 중인 요청에 값을 추가하면 요청이 이를 통과한다. 그렇지 않은 경우 이 레이어를 우회하고 나중에 관련 레이어로 이동한다. 이는 요청이 서비스 레이어를 우회하고 비즈니스 레이어에서 지속성 레이어로 이동하는 위의 다이어그램에서 볼 수 있다. 

그러나 열린 레이어를 사용하면 격리된 레이어의 이점이 사라진다. 지속성 레이어를 교체하려면 비즈니스 레이어뿐 아니라 개방형 서비스 레이어도 고려해야 한다. 이 두 레이어는 이제 지속성 레이어에 결합된다. 따라서 열린 레이어를 시스템에 추가하는 것은 매우 쉽지만 그렇게 해서는 안 된다. 우리는 아키텍처를 손상시키지 않고 문제를 해결하려고 노력해야 한다.

## 결론

Layered Architecture는 소프트웨어 아키텍처 패턴의 가장 단순한 형태이다. 사용자 수가 매우 적은( < 100–200 ) 초보적인 애플리케이션을 설계하고 라이브로 전환한 후 요구 사항이 너무 많이 변경되지 않을 것이라고 확신하는 경우 사용할 수 있는 최상의 소프트웨어 아키텍처 패턴이다. 이 아키텍처 패턴의 구현 비용은 다른 패턴에 비해 매우 적다.

### 장점

- 구성 요소가 특정 레이어에 속하므로 테스트하기 쉽다. 따라서 개별적으로 테스트할 수 있다.
- 당연히 대부분의 어플리케이션이 계층에서 작동하기 때문에 간단하고 구현하기 쉽다.

### 단점

- 특정 계층에 대한 변경이 가능하지만 응용 프로그램이 단일 단위이기 때문에 쉽지 않다. 또한 레이어 간의 결합이 더 어렵게 만드는 경향이 있다. 이것은 또한 확장을 어렵게 만든다.
- 단일 단위로 배포해야 하므로 특정 계층에 대한 변경은 전체 시스템을 다시 배포해야 함을 의미한다.
- 크기가 클수록 요청이 여러 계층을 통과하는 데 더 많은 리소스가 필요하므로 성능 문제가 발생한다.

# 참고문서
- [Software Architecture Patterns — Layered Architecture](https://priyalwalpita.medium.com/software-architecture-patterns-layered-architecture-a3b89b71a057)
